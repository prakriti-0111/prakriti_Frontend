"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6186],{10521:(e,r,t)=>{t.d(r,{F9:()=>d,QR:()=>l,VM:()=>h,jE:()=>i,kQ:()=>o,v7:()=>c});var s=t(80325),a=t(17942),n=t(45892);const i=e=>r=>{s.A.post("/customer/place-order",e).then((e=>{r({type:a.VN,payload:e.data})})).catch((e=>{}))},d=e=>(e=(0,n.x0)(e,!0),r=>{s.A.get("/customer/orders".concat(e)).then((e=>{e.data.success&&r({type:a.YE,payload:e.data.data})})).catch((e=>{}))}),l=e=>r=>{s.A.post("/customer/cancel-order",e).then((e=>{e.data.success&&r({type:a.jh,payload:e.data})})).catch((e=>{}))},c=e=>s.A.get("/customer/orders?order_id=".concat(e)),o=(e,r)=>s.A.post("/customer/return-request/".concat(e),r),h=e=>s.A.post("/customer/cancel-order",e)},46186:(e,r,t)=>{t.r(r),t.d(r,{default:()=>k});var s=t(63696),a=t(81660),n=t(19211),i=t(99101),d=t(675),l=t(8427),c=t(26692),o=t(47452),h=t(95851),u=t(22187),m=t(4295),x=t(58260),j=(t(6045),t(13031),t(36054),t(10521)),p=(t(46061),t(51038)),_=t(62540);const A=()=>(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("div",{className:"loader_content",children:(0,_.jsx)(p.A,{animation:"border",role:"status",children:(0,_.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})});var g=t(50977),v=t(80249),y=t(5908),b=t(60552),R=(t(35927),t(27397)),P=t(45892);function C(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}class N extends s.Component{constructor(e){super(e),C(this,"loadOrder",(async()=>{let e=await(0,j.v7)(this.props.params.id);if(e.data.success){let r=e.data.data.items;if(0==r.length)R.oR.error("Order not found."),this.props.navigate("/orders");else{let e=r[0],t=[];for(let r=0;r<e.orderProducts.length;r++)t.push({id:e.orderProducts[r].id,is_return:!1});this.setState({order:e,return_products:t,loading:!1})}}})),C(this,"handleCheckBox",((e,r)=>{let t=this.state.order.orderProducts,s=this.state.return_products;"material"==t[r].product_type?(this.setState({materialReturnDialog:!0,actionProductIndex:r}),s[r].is_return=!1):s[r].is_return=e.target.checked,this.setState({return_products:s},(()=>{this.calculateReturnAmount()}))})),C(this,"calculateReturnAmount",(()=>{let{order:e}=this.state,r=this.state.return_products,t=0,s=0,a=0;for(let n=0;n<r.length;n++)if(r[n].is_return)if("material"==e.orderProducts[n].product_type){let r=(0,P.XV)(parseFloat(e.orderProducts[n].materials[0].return_weight)*parseFloat(e.orderProducts[n].materials[0].rate)),i=e.is_due?0:parseFloat(e.orderProducts[n].return_charge_percent)>0?(0,P.XV)(r*parseFloat(e.orderProducts[n].return_charge_percent)/100):0;e.orderProducts[n].return_amount=r,e.orderProducts[n].return_charge=i,t+=r-i,s+=i,a+=r}else{let r=parseFloat(e.orderProducts[n].total),i=e.is_due?0:parseFloat(e.orderProducts[n].return_charge_percent)>0?r*parseFloat(e.orderProducts[n].return_charge_percent)/100:0;e.orderProducts[n].return_amount=r,e.orderProducts[n].return_charge=i,t+=r-i,s+=i,a+=r}this.setState({return_amount:(0,P.XV)(t,!0),product_amount:(0,P.XV)(a,!0),return_charge:(0,P.XV)(s,!0),order:e})})),C(this,"handleReturnMaterial",((e,r)=>{let{order:t,actionProductIndex:s}=this.state;t.orderProducts[s].materials[0][r]=e,this.setState({order:t})})),C(this,"setOpen",(e=>{let r=this.state.view_open;r[e]=!this.checkOpen(e),this.setState({view_open:r})})),C(this,"checkOpen",(e=>{let r=this.state.view_open;return!(!(e in r)||!r[e])})),C(this,"handleMaterialReturnClose",(()=>{this.setState({materialReturnDialog:!1})})),C(this,"handleReturnMaterialSubmit",(()=>{let{order:e,actionProductIndex:r}=this.state;const t=e.orderProducts[r];let s=!1;if(!t.materials[0].return_weight||parseFloat(t.materials[0].return_weight)>parseFloat(t.materials[0].avl_weight)?(s=!0,this.setState({return_weight_error:!0}),parseFloat(t.materials[0].return_weight)>parseFloat(t.materials[0].avl_weight)&&R.oR.error("Weight can't be more than available weight.")):this.setState({return_weight_error:!1}),!t.materials[0].return_qty||parseFloat(t.materials[0].return_qty)>parseFloat(t.materials[0].avl_qty)?(s=!0,this.setState({return_qty_error:!0}),parseFloat(t.materials[0].return_qty)>parseFloat(t.materials[0].avl_qty)&&R.oR.error("Quantity can't be more than available quantity.")):this.setState({return_qty_error:!1}),!s){let e=this.state.return_products;e[r].is_return=!0,this.setState({materialReturnDialog:!1,return_products:e},(()=>{this.calculateReturnAmount()}))}})),C(this,"hasReturn",(()=>{let e=!1;for(let r=0;r<this.state.return_products.length;r++)if(this.state.return_products[r].is_return){e=!0;break}return e})),C(this,"handleReturnConfirm",(()=>{this.setState({returnDialog:!0})})),C(this,"handleReturnSubmit",(async()=>{let e=this.state.order;if(this.isEmptyOrSpaces(this.state.reason))this.setState({processing:!1,reason_err:"Please write valid reason."});else{this.setState({reason_err:"",processing:!0});let r=await(0,j.kQ)(e.id,{notes:this.state.reason,return_products:this.state.return_products,order_products:this.state.order.orderProducts,return_amount:this.state.return_amount,product_amount:this.state.product_amount,return_charge:this.state.return_charge});r.data.success?(R.oR.success(r.data.message),this.props.navigate("/orders/"+e.id)):(R.oR.error(r.data.message),this.setState({processing:!1}))}})),C(this,"handleReturnClose",(()=>{this.setState({returnDialog:!1})})),this.state={order:null,loading:!0,processing:!1,return_products:[],materialReturnDialog:!1,return_amount:0,product_amount:0,return_charge:0,actionProductIndex:0,return_weight_error:!1,return_qty_error:!1,view_open:{},reason:"",reason_err:"",returnDialog:!1}}componentDidMount(){this.loadOrder()}componentDidUpdate(e){e.params.id!=this.props.params.id&&this.loadOrder()}static getDerivedStateFromProps(e,r){return{}}isEmptyOrSpaces(e){return null===e||null!==e.match(/^ *$/)}render(){let{order:e,actionProductIndex:r,return_products:t}=this.state,s=e?e.orderProducts[r]:null;return(0,_.jsx)(_.Fragment,{children:this.state.loading?(0,_.jsx)(A,{}):(0,_.jsx)(_.Fragment,{children:e&&"delivered"==e.status?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"order-summary-wrapper desktop-summary-wrapper",children:(0,_.jsxs)(a.A,{children:[(0,_.jsxs)(m.A,{children:[(0,_.jsx)(m.A.Item,{href:"/",children:"My Account"}),(0,_.jsx)(m.A.Item,{href:"/orders",children:"My Orders"}),(0,_.jsx)(m.A.Item,{active:!0,children:"Order Return"})]}),(0,_.jsxs)(n.A,{children:[(0,_.jsxs)(i.A,{xs:12,md:8,children:[(0,_.jsxs)("h2",{className:"mb-1",children:[" #",e.order_no]}),(0,_.jsxs)(d.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{}),(0,_.jsx)("th",{children:"Product Name"}),(0,_.jsx)("th",{children:"Size"}),(0,_.jsx)("th",{children:"Materials"}),(0,_.jsx)("th",{children:"Total"})]})}),(0,_.jsx)("tbody",{children:e.orderProducts.map(((e,r)=>(0,_.jsxs)("tr",{children:[(0,_.jsxs)("td",{children:[(0,_.jsx)(l.A.Group,{children:(0,_.jsx)(l.A.Check,{type:"checkbox",value:e.is_return,label:"",id:"product_".concat(e.id),checked:t[r].is_return,onChange:e=>this.handleCheckBox(e,r)})}),"material"==e.product_type&&e.materials[0].return_weight?(0,_.jsx)(u.A,{variant:"light",children:this.checkOpen(e.id)?(0,_.jsx)(x.yL8,{}):(0,_.jsx)(x.nfB,{})}):null]}),(0,_.jsx)("td",{children:e.product_name}),(0,_.jsx)("td",{children:e.size_name}),(0,_.jsx)("td",{children:(0,_.jsxs)(d.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:"Name"}),(0,_.jsx)("th",{children:"Weight"}),(0,_.jsx)("th",{children:"Quantity"})]})}),(0,_.jsx)("tbody",{children:e.materials.map(((e,r)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:e.material_name}),(0,_.jsxs)("td",{children:[e.weight," ",e.unit_name]}),(0,_.jsx)("td",{children:e.quantity})]},r)))})]})}),(0,_.jsx)("td",{children:e.rate})]},r)))})]})]}),(0,_.jsxs)(i.A,{xs:12,sm:12,md:4,children:[(0,_.jsx)("h2",{className:"mb-1",children:" "}),(0,_.jsx)("div",{className:"summary-content-right mb-4",children:(0,_.jsxs)("ul",{children:[(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{children:"Return Product Amount:"}),(0,_.jsx)("span",{children:(0,P.Pt)(this.state.product_amount)})]}),(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{children:"Return Charge:"}),(0,_.jsx)("span",{children:(0,P.Pt)(this.state.return_charge)})]}),(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{children:"Return Amount:"}),(0,_.jsx)("span",{children:(0,P.Pt)(this.state.return_amount)})]}),this.hasReturn()?(0,_.jsx)("li",{className:"place-order-button mt-4",children:(0,_.jsx)(u.A,{variant:"primary",className:"dark_button",onClick:this.handleReturnConfirm,children:"Return Request"})}):null]})})]})]})]})}),(0,_.jsx)("div",{className:"order-summary-wrapper mobile-summary-wrapper",children:(0,_.jsxs)(a.A,{children:[(0,_.jsxs)(m.A,{children:[(0,_.jsx)(m.A.Item,{href:"/",children:"My Account"}),(0,_.jsx)(m.A.Item,{href:"/orders",children:"My Orders"}),(0,_.jsx)(m.A.Item,{active:!0,children:"Order Return"})]}),(0,_.jsxs)(n.A,{children:[(0,_.jsxs)(i.A,{xs:12,md:8,children:[(0,_.jsxs)("h2",{className:"mb-1",children:[" #",e.order_no]}),(0,_.jsxs)(d.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{}),(0,_.jsx)("th",{children:"Product Name"}),(0,_.jsx)("th",{children:"Size"}),(0,_.jsx)("th",{children:"Materials"}),(0,_.jsx)("th",{children:"Total"})]})}),(0,_.jsx)("tbody",{children:e.orderProducts.map(((e,r)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:(0,_.jsx)(l.A.Group,{children:(0,_.jsx)(l.A.Check,{type:"checkbox",value:e.is_return,label:"",id:"product_".concat(e.id),checked:t[r].is_return,onChange:e=>this.handleCheckBox(e,r)})})}),(0,_.jsx)("td",{children:e.product_name}),(0,_.jsx)("td",{children:e.size_name}),(0,_.jsx)("td",{children:(0,_.jsxs)(d.A,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[(0,_.jsx)("thead",{children:(0,_.jsxs)("tr",{children:[(0,_.jsx)("th",{children:"Name"}),(0,_.jsx)("th",{children:"Weight"}),(0,_.jsx)("th",{children:"Quantity"})]})}),(0,_.jsx)("tbody",{children:e.materials.map(((e,r)=>(0,_.jsxs)("tr",{children:[(0,_.jsx)("td",{children:e.material_name}),(0,_.jsxs)("td",{children:[e.weight," ",e.unit_name]}),(0,_.jsx)("td",{children:e.quantity})]},r)))})]})}),(0,_.jsx)("td",{children:e.rate})]},r)))})]})]}),(0,_.jsxs)(i.A,{xs:12,sm:12,md:4,children:[(0,_.jsx)("h2",{className:"mb-1",children:" "}),(0,_.jsx)("div",{className:"summary-content-right mb-4",children:(0,_.jsxs)("ul",{children:[(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{children:"Return Product Amount:"}),(0,_.jsx)("span",{children:(0,P.Pt)(this.state.product_amount)})]}),(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{children:"Return Charge:"}),(0,_.jsx)("span",{children:(0,P.Pt)(this.state.return_charge)})]}),(0,_.jsxs)("li",{children:[(0,_.jsx)("span",{children:"Return Amount:"}),(0,_.jsx)("span",{children:(0,P.Pt)(this.state.return_amount)})]}),this.hasReturn()?(0,_.jsx)("li",{className:"place-order-button mt-4",children:(0,_.jsx)(u.A,{variant:"primary",className:"dark_button",onClick:this.handleReturnConfirm,children:"Return Request"})}):null]})})]})]})]})}),(0,_.jsxs)(c.A,{show:this.state.materialReturnDialog,onHide:this.handleMaterialReturnClose,backdrop:"static",keyboard:!1,children:[(0,_.jsx)(c.A.Header,{closeButton:!0,children:(0,_.jsx)(c.A.Title,{children:"Return Product"})}),(0,_.jsx)(c.A.Body,{children:(0,_.jsxs)(n.A,{children:[(0,_.jsx)(i.A,{xs:12,md:6,className:"mt-2",children:(0,_.jsx)(o.A,{children:(0,_.jsx)(h.A,{label:"Product Name",children:(0,_.jsx)(l.A.Control,{value:s.product_name,disabled:!0})})})}),(0,_.jsx)(i.A,{xs:12,md:6,className:"mt-2",children:(0,_.jsx)(o.A,{children:(0,_.jsx)(h.A,{label:"Purity",children:(0,_.jsx)(l.A.Control,{value:s.materials[0].purity_name,disabled:!0})})})}),(0,_.jsx)(i.A,{xs:12,md:6,className:"mt-2",children:(0,_.jsx)(o.A,{children:(0,_.jsx)(h.A,{label:"Avl Qty",children:(0,_.jsx)(l.A.Control,{value:s.materials[0].avl_qty,disabled:!0})})})}),(0,_.jsx)(i.A,{xs:12,md:6,className:"mt-2",children:(0,_.jsx)(o.A,{children:(0,_.jsx)(h.A,{label:"Avl Weight",children:(0,_.jsx)(l.A.Control,{value:s.materials[0].avl_weight+" "+s.materials[0].unit_name,disabled:!0})})})}),(0,_.jsx)(i.A,{xs:12,md:6,className:"mt-2",children:(0,_.jsx)(o.A,{children:(0,_.jsx)(h.A,{label:"Quantity",className:this.state.return_qty_error?" error_input":"",children:(0,_.jsx)(l.A.Control,{value:s.materials[0].return_qty,onChange:e=>this.handleReturnMaterial(e.target.value,"return_qty")})})})}),(0,_.jsx)(i.A,{xs:12,md:6,className:"mt-2",children:(0,_.jsx)(o.A,{children:(0,_.jsx)(h.A,{label:"Weight",className:this.state.return_weight_error?" error_input":"",children:(0,_.jsx)(l.A.Control,{value:s.materials[0].return_weight,onChange:e=>this.handleReturnMaterial(e.target.value,"return_weight")})})})})]})}),(0,_.jsxs)(c.A.Footer,{children:[(0,_.jsx)(u.A,{variant:"secondary",onClick:this.handleMaterialReturnClose,children:"Close"}),(0,_.jsx)(u.A,{variant:"primary",onClick:this.handleReturnMaterialSubmit,disabled:this.state.processing,children:"Submit"})]})]}),(0,_.jsxs)(c.A,{show:this.state.returnDialog,onHide:this.handleReturnClose,backdrop:"static",keyboard:!1,children:[(0,_.jsx)(c.A.Header,{closeButton:!0,children:(0,_.jsx)(c.A.Title,{children:"Return Order"})}),(0,_.jsx)(c.A.Body,{children:(0,_.jsx)(n.A,{children:(0,_.jsx)(i.A,{xs:12,md:12,className:"mt-3",children:(0,_.jsxs)(l.A.Group,{children:[(0,_.jsx)(h.A,{controlId:"floatingTextarea3",label:"Reason",className:this.state.reason_err?"is-invalid":"",children:(0,_.jsx)(l.A.Control,{as:"textarea",style:{height:"100px"},onChange:e=>this.setState({reason:e.target.value})})}),(0,_.jsx)(l.A.Control.Feedback,{type:"invalid",children:this.state.reason_err})]})})})}),(0,_.jsxs)(c.A.Footer,{children:[(0,_.jsx)(u.A,{variant:"secondary",onClick:this.handleReturnClose,children:"Close"}),(0,_.jsx)(u.A,{variant:"primary",onClick:this.handleReturnSubmit,disabled:this.state.processing,children:"Submit"})]})]})]}):(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)("div",{className:"no-product",children:[(0,_.jsx)("img",{src:b.A,alt:""}),(0,_.jsx)("h1",{className:"mb-0",children:"Order Not Found"})]})})})})}}const k=(0,g.A)((0,v.Ng)((e=>({})),(e=>({dispatch:e,actions:(0,y.zH)({},e)})))(N))},6045:(e,r,t)=>{t.p},36054:(e,r,t)=>{t.p},60552:(e,r,t)=>{t.d(r,{A:()=>s});const s=t.p+"assets/no-product.png"},13031:(e,r,t)=>{t.d(r,{A:()=>s});const s=t.p+"assets/order-item.png"},675:(e,r,t)=>{t.d(r,{A:()=>l});var s=t(71633),a=t.n(s),n=t(63696),i=t(71971),d=t(62540);const l=n.forwardRef((({bsPrefix:e,className:r,striped:t,bordered:s,borderless:n,hover:l,size:c,variant:o,responsive:h,...u},m)=>{const x=(0,i.oU)(e,"table"),j=a()(r,x,o&&`${x}-${o}`,c&&`${x}-${c}`,t&&`${x}-${"string"==typeof t?`striped-${t}`:"striped"}`,s&&`${x}-bordered`,n&&`${x}-borderless`,l&&`${x}-hover`),p=(0,d.jsx)("table",{...u,className:j,ref:m});if(h){let e=`${x}-responsive`;return"string"==typeof h&&(e=`${e}-${h}`),(0,d.jsx)("div",{className:e,children:p})}return p}))}}]);